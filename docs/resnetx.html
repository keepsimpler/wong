---

title: Title
keywords: fastai
sidebar: home_sidebar

summary: "summary"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/04_resnetx.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_pred" class="doc_header"><code>get_pred</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/resnetx.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_pred</code>(<strong><code>l</code></strong>:<code>int</code>, <strong><code>start_id</code></strong>:<code>int</code>, <strong><code>d</code></strong>:<code>int</code>=<em><code>1</code></em>)</p>
</blockquote>
<p>get predecessor layer id.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Parameters:</p>
<ul>
<li>l : current layer id.</li>
<li>start_id : index of the starting node</li>
<li>d : fold depth.</li>
</ul>
<p>Return:</p>
<ul>
<li>The previous layer id that directly link to the current layer.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_pred</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">start_id</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>44</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">get_pred</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">start_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">11</span><span class="p">)</span>

<span class="n">test_eq</span><span class="p">(</span><span class="n">get_pred</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">start_id</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">get_pred</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">start_id</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="layer_diff" class="doc_header"><code>layer_diff</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/resnetx.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>layer_diff</code>(<strong><code>cur</code></strong>:<code>int</code>, <strong><code>pred</code></strong>:<code>int</code>, <strong><code>num_nodes</code></strong>:<code>tuple</code>)</p>
</blockquote>
<p>layer difference between the current layer and the predecessor layer.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">cur</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="mi">0</span>
<span class="n">layer_diff</span><span class="p">(</span><span class="n">cur</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Parameters:</p>
<ul>
<li>Stem : the stemming stage, which accept original images, transform them, then input into the backbone network.</li>
<li>Unit : the operation at nodes.</li>
<li>fold : the fold depth</li>
<li>ni : number of input channels of the backbone network.</li>
<li><em>num_stages : number of stages in the backbone network.</em></li>
<li>num_nodes : number of nodes of every stage in the backbone network.</li>
<li>start_id : index of starting node of ResNetX</li>
<li>base : standard width of channels in the backbone network.</li>
<li>exp : expansion along with the increase of stages.</li>
<li>bottle_scale : bottleneck scale</li>
<li>first_downsample: dose down-sample at the start of the first stage.</li>
<li>deep_stem : using 7x7 or 3 3x3 conv in stemming stage.</li>
<li>c_in : number of input channels of the Start layer</li>
<li>c_out : number of classes in the output of the final classifier.</li>
<li>kwargs : arguments translate into <code>Unit</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ResNetX" class="doc_header"><code>class</code> <code>ResNetX</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/resnetx.py#L49" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ResNetX</code>(<strong><code>Stem</code></strong>, <strong><code>Unit</code></strong>, <strong><code>fold</code></strong>:<code>int</code>, <strong><code>ni</code></strong>:<code>int</code>, <strong><code>num_nodes</code></strong>:<code>tuple</code>, <strong><code>start_id</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>base</code></strong>:<code>int</code>=<em><code>64</code></em>, <strong><code>exp</code></strong>:<code>int</code>=<em><code>2</code></em>, <strong><code>bottle_scale</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>first_downsample</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>deep_stem</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>c_in</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong><code>c_out</code></strong>:<code>int</code>=<em><code>10</code></em>, <strong>**<code>kwargs</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>A folded resnet.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resnet_local_to_pretrained" class="doc_header"><code>resnet_local_to_pretrained</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/resnetx.py#L148" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resnet_local_to_pretrained</code>(<strong><code>num_nodes</code></strong>, <strong><code>start_id</code></strong>, <strong><code>fold</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resnetx152" class="doc_header"><code>resnetx152</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/resnetx.py#L182" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resnetx152</code>(<strong><code>cfg_file</code></strong>:<code>str</code>, <strong><code>fold</code></strong>:<code>int</code>, <strong><code>start_id</code></strong>:<code>int</code>, <strong><code>pretrained</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cfg_file</span> <span class="o">=</span> <span class="s1">&#39;configs/imagenet/resnet/resnet152.yaml&#39;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">resnetx152</span><span class="p">(</span><span class="n">cfg_file</span><span class="p">,</span> <span class="n">fold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">start_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cur = 1 , pred = 0 ,diff = 1
cur = 2 , pred = 1 ,diff = 0
cur = 3 , pred = 2 ,diff = 0
cur = 4 , pred = 3 ,diff = 1
cur = 5 , pred = 4 ,diff = 0
cur = 6 , pred = 5 ,diff = 0
cur = 7 , pred = 6 ,diff = 0
cur = 8 , pred = 7 ,diff = 0
cur = 9 , pred = 8 ,diff = 0
cur = 10 , pred = 9 ,diff = 0
cur = 11 , pred = 10 ,diff = 0
cur = 12 , pred = 11 ,diff = 1
cur = 13 , pred = 12 ,diff = 0
cur = 14 , pred = 13 ,diff = 0
cur = 15 , pred = 14 ,diff = 0
cur = 16 , pred = 15 ,diff = 0
cur = 17 , pred = 16 ,diff = 0
cur = 18 , pred = 17 ,diff = 0
cur = 19 , pred = 18 ,diff = 0
cur = 20 , pred = 19 ,diff = 0
cur = 21 , pred = 20 ,diff = 0
cur = 22 , pred = 21 ,diff = 0
cur = 23 , pred = 22 ,diff = 0
cur = 24 , pred = 23 ,diff = 0
cur = 25 , pred = 24 ,diff = 0
cur = 26 , pred = 25 ,diff = 0
cur = 27 , pred = 26 ,diff = 0
cur = 28 , pred = 27 ,diff = 0
cur = 29 , pred = 28 ,diff = 0
cur = 30 , pred = 29 ,diff = 0
cur = 31 , pred = 30 ,diff = 0
cur = 32 , pred = 31 ,diff = 0
cur = 33 , pred = 32 ,diff = 0
cur = 34 , pred = 33 ,diff = 0
cur = 35 , pred = 34 ,diff = 0
cur = 36 , pred = 35 ,diff = 0
cur = 37 , pred = 36 ,diff = 0
cur = 38 , pred = 37 ,diff = 0
cur = 39 , pred = 38 ,diff = 0
cur = 40 , pred = 39 ,diff = 0
cur = 41 , pred = 40 ,diff = 0
cur = 42 , pred = 41 ,diff = 0
cur = 43 , pred = 42 ,diff = 0
cur = 44 , pred = 43 ,diff = 0
cur = 45 , pred = 44 ,diff = 0
cur = 46 , pred = 45 ,diff = 0
cur = 47 , pred = 46 ,diff = 0
cur = 48 , pred = 47 ,diff = 1
cur = 49 , pred = 48 ,diff = 0
cur = 50 , pred = 49 ,diff = 0
conv1.weight
bn1.weight
bn1.bias
bn1.running_mean
bn1.running_var
layer1.0.conv1.weight
layer1.0.bn1.weight
layer1.0.bn1.bias
layer1.0.bn1.running_mean
layer1.0.bn1.running_var
layer1.0.conv2.weight
layer1.0.bn2.weight
layer1.0.bn2.bias
layer1.0.bn2.running_mean
layer1.0.bn2.running_var
layer1.0.conv3.weight
layer1.0.bn3.weight
layer1.0.bn3.bias
layer1.0.bn3.running_mean
layer1.0.bn3.running_var
layer1.1.conv1.weight
layer1.1.bn1.weight
layer1.1.bn1.bias
layer1.1.bn1.running_mean
layer1.1.bn1.running_var
layer1.1.conv2.weight
layer1.1.bn2.weight
layer1.1.bn2.bias
layer1.1.bn2.running_mean
layer1.1.bn2.running_var
layer1.1.conv3.weight
layer1.1.bn3.weight
layer1.1.bn3.bias
layer1.1.bn3.running_mean
layer1.1.bn3.running_var
layer1.2.conv1.weight
layer1.2.bn1.weight
layer1.2.bn1.bias
layer1.2.bn1.running_mean
layer1.2.bn1.running_var
layer1.2.conv2.weight
layer1.2.bn2.weight
layer1.2.bn2.bias
layer1.2.bn2.running_mean
layer1.2.bn2.running_var
layer1.2.conv3.weight
layer1.2.bn3.weight
layer1.2.bn3.bias
layer1.2.bn3.running_mean
layer1.2.bn3.running_var
layer2.0.conv1.weight
layer2.0.bn1.weight
layer2.0.bn1.bias
layer2.0.bn1.running_mean
layer2.0.bn1.running_var
layer2.0.conv2.weight
layer2.0.bn2.weight
layer2.0.bn2.bias
layer2.0.bn2.running_mean
layer2.0.bn2.running_var
layer2.0.conv3.weight
layer2.0.bn3.weight
layer2.0.bn3.bias
layer2.0.bn3.running_mean
layer2.0.bn3.running_var
layer2.1.conv1.weight
layer2.1.bn1.weight
layer2.1.bn1.bias
layer2.1.bn1.running_mean
layer2.1.bn1.running_var
layer2.1.conv2.weight
layer2.1.bn2.weight
layer2.1.bn2.bias
layer2.1.bn2.running_mean
layer2.1.bn2.running_var
layer2.1.conv3.weight
layer2.1.bn3.weight
layer2.1.bn3.bias
layer2.1.bn3.running_mean
layer2.1.bn3.running_var
layer2.2.conv1.weight
layer2.2.bn1.weight
layer2.2.bn1.bias
layer2.2.bn1.running_mean
layer2.2.bn1.running_var
layer2.2.conv2.weight
layer2.2.bn2.weight
layer2.2.bn2.bias
layer2.2.bn2.running_mean
layer2.2.bn2.running_var
layer2.2.conv3.weight
layer2.2.bn3.weight
layer2.2.bn3.bias
layer2.2.bn3.running_mean
layer2.2.bn3.running_var
layer2.3.conv1.weight
layer2.3.bn1.weight
layer2.3.bn1.bias
layer2.3.bn1.running_mean
layer2.3.bn1.running_var
layer2.3.conv2.weight
layer2.3.bn2.weight
layer2.3.bn2.bias
layer2.3.bn2.running_mean
layer2.3.bn2.running_var
layer2.3.conv3.weight
layer2.3.bn3.weight
layer2.3.bn3.bias
layer2.3.bn3.running_mean
layer2.3.bn3.running_var
layer2.4.conv1.weight
layer2.4.bn1.weight
layer2.4.bn1.bias
layer2.4.bn1.running_mean
layer2.4.bn1.running_var
layer2.4.conv2.weight
layer2.4.bn2.weight
layer2.4.bn2.bias
layer2.4.bn2.running_mean
layer2.4.bn2.running_var
layer2.4.conv3.weight
layer2.4.bn3.weight
layer2.4.bn3.bias
layer2.4.bn3.running_mean
layer2.4.bn3.running_var
layer2.5.conv1.weight
layer2.5.bn1.weight
layer2.5.bn1.bias
layer2.5.bn1.running_mean
layer2.5.bn1.running_var
layer2.5.conv2.weight
layer2.5.bn2.weight
layer2.5.bn2.bias
layer2.5.bn2.running_mean
layer2.5.bn2.running_var
layer2.5.conv3.weight
layer2.5.bn3.weight
layer2.5.bn3.bias
layer2.5.bn3.running_mean
layer2.5.bn3.running_var
layer2.6.conv1.weight
layer2.6.bn1.weight
layer2.6.bn1.bias
layer2.6.bn1.running_mean
layer2.6.bn1.running_var
layer2.6.conv2.weight
layer2.6.bn2.weight
layer2.6.bn2.bias
layer2.6.bn2.running_mean
layer2.6.bn2.running_var
layer2.6.conv3.weight
layer2.6.bn3.weight
layer2.6.bn3.bias
layer2.6.bn3.running_mean
layer2.6.bn3.running_var
layer2.7.conv1.weight
layer2.7.bn1.weight
layer2.7.bn1.bias
layer2.7.bn1.running_mean
layer2.7.bn1.running_var
layer2.7.conv2.weight
layer2.7.bn2.weight
layer2.7.bn2.bias
layer2.7.bn2.running_mean
layer2.7.bn2.running_var
layer2.7.conv3.weight
layer2.7.bn3.weight
layer2.7.bn3.bias
layer2.7.bn3.running_mean
layer2.7.bn3.running_var
layer3.0.conv1.weight
layer3.0.bn1.weight
layer3.0.bn1.bias
layer3.0.bn1.running_mean
layer3.0.bn1.running_var
layer3.0.conv2.weight
layer3.0.bn2.weight
layer3.0.bn2.bias
layer3.0.bn2.running_mean
layer3.0.bn2.running_var
layer3.0.conv3.weight
layer3.0.bn3.weight
layer3.0.bn3.bias
layer3.0.bn3.running_mean
layer3.0.bn3.running_var
layer3.1.conv1.weight
layer3.1.bn1.weight
layer3.1.bn1.bias
layer3.1.bn1.running_mean
layer3.1.bn1.running_var
layer3.1.conv2.weight
layer3.1.bn2.weight
layer3.1.bn2.bias
layer3.1.bn2.running_mean
layer3.1.bn2.running_var
layer3.1.conv3.weight
layer3.1.bn3.weight
layer3.1.bn3.bias
layer3.1.bn3.running_mean
layer3.1.bn3.running_var
layer3.2.conv1.weight
layer3.2.bn1.weight
layer3.2.bn1.bias
layer3.2.bn1.running_mean
layer3.2.bn1.running_var
layer3.2.conv2.weight
layer3.2.bn2.weight
layer3.2.bn2.bias
layer3.2.bn2.running_mean
layer3.2.bn2.running_var
layer3.2.conv3.weight
layer3.2.bn3.weight
layer3.2.bn3.bias
layer3.2.bn3.running_mean
layer3.2.bn3.running_var
layer3.3.conv1.weight
layer3.3.bn1.weight
layer3.3.bn1.bias
layer3.3.bn1.running_mean
layer3.3.bn1.running_var
layer3.3.conv2.weight
layer3.3.bn2.weight
layer3.3.bn2.bias
layer3.3.bn2.running_mean
layer3.3.bn2.running_var
layer3.3.conv3.weight
layer3.3.bn3.weight
layer3.3.bn3.bias
layer3.3.bn3.running_mean
layer3.3.bn3.running_var
layer3.4.conv1.weight
layer3.4.bn1.weight
layer3.4.bn1.bias
layer3.4.bn1.running_mean
layer3.4.bn1.running_var
layer3.4.conv2.weight
layer3.4.bn2.weight
layer3.4.bn2.bias
layer3.4.bn2.running_mean
layer3.4.bn2.running_var
layer3.4.conv3.weight
layer3.4.bn3.weight
layer3.4.bn3.bias
layer3.4.bn3.running_mean
layer3.4.bn3.running_var
layer3.5.conv1.weight
layer3.5.bn1.weight
layer3.5.bn1.bias
layer3.5.bn1.running_mean
layer3.5.bn1.running_var
layer3.5.conv2.weight
layer3.5.bn2.weight
layer3.5.bn2.bias
layer3.5.bn2.running_mean
layer3.5.bn2.running_var
layer3.5.conv3.weight
layer3.5.bn3.weight
layer3.5.bn3.bias
layer3.5.bn3.running_mean
layer3.5.bn3.running_var
layer3.6.conv1.weight
layer3.6.bn1.weight
layer3.6.bn1.bias
layer3.6.bn1.running_mean
layer3.6.bn1.running_var
layer3.6.conv2.weight
layer3.6.bn2.weight
layer3.6.bn2.bias
layer3.6.bn2.running_mean
layer3.6.bn2.running_var
layer3.6.conv3.weight
layer3.6.bn3.weight
layer3.6.bn3.bias
layer3.6.bn3.running_mean
layer3.6.bn3.running_var
layer3.7.conv1.weight
layer3.7.bn1.weight
layer3.7.bn1.bias
layer3.7.bn1.running_mean
layer3.7.bn1.running_var
layer3.7.conv2.weight
layer3.7.bn2.weight
layer3.7.bn2.bias
layer3.7.bn2.running_mean
layer3.7.bn2.running_var
layer3.7.conv3.weight
layer3.7.bn3.weight
layer3.7.bn3.bias
layer3.7.bn3.running_mean
layer3.7.bn3.running_var
layer3.8.conv1.weight
layer3.8.bn1.weight
layer3.8.bn1.bias
layer3.8.bn1.running_mean
layer3.8.bn1.running_var
layer3.8.conv2.weight
layer3.8.bn2.weight
layer3.8.bn2.bias
layer3.8.bn2.running_mean
layer3.8.bn2.running_var
layer3.8.conv3.weight
layer3.8.bn3.weight
layer3.8.bn3.bias
layer3.8.bn3.running_mean
layer3.8.bn3.running_var
layer3.9.conv1.weight
layer3.9.bn1.weight
layer3.9.bn1.bias
layer3.9.bn1.running_mean
layer3.9.bn1.running_var
layer3.9.conv2.weight
layer3.9.bn2.weight
layer3.9.bn2.bias
layer3.9.bn2.running_mean
layer3.9.bn2.running_var
layer3.9.conv3.weight
layer3.9.bn3.weight
layer3.9.bn3.bias
layer3.9.bn3.running_mean
layer3.9.bn3.running_var
layer3.10.conv1.weight
layer3.10.bn1.weight
layer3.10.bn1.bias
layer3.10.bn1.running_mean
layer3.10.bn1.running_var
layer3.10.conv2.weight
layer3.10.bn2.weight
layer3.10.bn2.bias
layer3.10.bn2.running_mean
layer3.10.bn2.running_var
layer3.10.conv3.weight
layer3.10.bn3.weight
layer3.10.bn3.bias
layer3.10.bn3.running_mean
layer3.10.bn3.running_var
layer3.11.conv1.weight
layer3.11.bn1.weight
layer3.11.bn1.bias
layer3.11.bn1.running_mean
layer3.11.bn1.running_var
layer3.11.conv2.weight
layer3.11.bn2.weight
layer3.11.bn2.bias
layer3.11.bn2.running_mean
layer3.11.bn2.running_var
layer3.11.conv3.weight
layer3.11.bn3.weight
layer3.11.bn3.bias
layer3.11.bn3.running_mean
layer3.11.bn3.running_var
layer3.12.conv1.weight
layer3.12.bn1.weight
layer3.12.bn1.bias
layer3.12.bn1.running_mean
layer3.12.bn1.running_var
layer3.12.conv2.weight
layer3.12.bn2.weight
layer3.12.bn2.bias
layer3.12.bn2.running_mean
layer3.12.bn2.running_var
layer3.12.conv3.weight
layer3.12.bn3.weight
layer3.12.bn3.bias
layer3.12.bn3.running_mean
layer3.12.bn3.running_var
layer3.13.conv1.weight
layer3.13.bn1.weight
layer3.13.bn1.bias
layer3.13.bn1.running_mean
layer3.13.bn1.running_var
layer3.13.conv2.weight
layer3.13.bn2.weight
layer3.13.bn2.bias
layer3.13.bn2.running_mean
layer3.13.bn2.running_var
layer3.13.conv3.weight
layer3.13.bn3.weight
layer3.13.bn3.bias
layer3.13.bn3.running_mean
layer3.13.bn3.running_var
layer3.14.conv1.weight
layer3.14.bn1.weight
layer3.14.bn1.bias
layer3.14.bn1.running_mean
layer3.14.bn1.running_var
layer3.14.conv2.weight
layer3.14.bn2.weight
layer3.14.bn2.bias
layer3.14.bn2.running_mean
layer3.14.bn2.running_var
layer3.14.conv3.weight
layer3.14.bn3.weight
layer3.14.bn3.bias
layer3.14.bn3.running_mean
layer3.14.bn3.running_var
layer3.15.conv1.weight
layer3.15.bn1.weight
layer3.15.bn1.bias
layer3.15.bn1.running_mean
layer3.15.bn1.running_var
layer3.15.conv2.weight
layer3.15.bn2.weight
layer3.15.bn2.bias
layer3.15.bn2.running_mean
layer3.15.bn2.running_var
layer3.15.conv3.weight
layer3.15.bn3.weight
layer3.15.bn3.bias
layer3.15.bn3.running_mean
layer3.15.bn3.running_var
layer3.16.conv1.weight
layer3.16.bn1.weight
layer3.16.bn1.bias
layer3.16.bn1.running_mean
layer3.16.bn1.running_var
layer3.16.conv2.weight
layer3.16.bn2.weight
layer3.16.bn2.bias
layer3.16.bn2.running_mean
layer3.16.bn2.running_var
layer3.16.conv3.weight
layer3.16.bn3.weight
layer3.16.bn3.bias
layer3.16.bn3.running_mean
layer3.16.bn3.running_var
layer3.17.conv1.weight
layer3.17.bn1.weight
layer3.17.bn1.bias
layer3.17.bn1.running_mean
layer3.17.bn1.running_var
layer3.17.conv2.weight
layer3.17.bn2.weight
layer3.17.bn2.bias
layer3.17.bn2.running_mean
layer3.17.bn2.running_var
layer3.17.conv3.weight
layer3.17.bn3.weight
layer3.17.bn3.bias
layer3.17.bn3.running_mean
layer3.17.bn3.running_var
layer3.18.conv1.weight
layer3.18.bn1.weight
layer3.18.bn1.bias
layer3.18.bn1.running_mean
layer3.18.bn1.running_var
layer3.18.conv2.weight
layer3.18.bn2.weight
layer3.18.bn2.bias
layer3.18.bn2.running_mean
layer3.18.bn2.running_var
layer3.18.conv3.weight
layer3.18.bn3.weight
layer3.18.bn3.bias
layer3.18.bn3.running_mean
layer3.18.bn3.running_var
layer3.19.conv1.weight
layer3.19.bn1.weight
layer3.19.bn1.bias
layer3.19.bn1.running_mean
layer3.19.bn1.running_var
layer3.19.conv2.weight
layer3.19.bn2.weight
layer3.19.bn2.bias
layer3.19.bn2.running_mean
layer3.19.bn2.running_var
layer3.19.conv3.weight
layer3.19.bn3.weight
layer3.19.bn3.bias
layer3.19.bn3.running_mean
layer3.19.bn3.running_var
layer3.20.conv1.weight
layer3.20.bn1.weight
layer3.20.bn1.bias
layer3.20.bn1.running_mean
layer3.20.bn1.running_var
layer3.20.conv2.weight
layer3.20.bn2.weight
layer3.20.bn2.bias
layer3.20.bn2.running_mean
layer3.20.bn2.running_var
layer3.20.conv3.weight
layer3.20.bn3.weight
layer3.20.bn3.bias
layer3.20.bn3.running_mean
layer3.20.bn3.running_var
layer3.21.conv1.weight
layer3.21.bn1.weight
layer3.21.bn1.bias
layer3.21.bn1.running_mean
layer3.21.bn1.running_var
layer3.21.conv2.weight
layer3.21.bn2.weight
layer3.21.bn2.bias
layer3.21.bn2.running_mean
layer3.21.bn2.running_var
layer3.21.conv3.weight
layer3.21.bn3.weight
layer3.21.bn3.bias
layer3.21.bn3.running_mean
layer3.21.bn3.running_var
layer3.22.conv1.weight
layer3.22.bn1.weight
layer3.22.bn1.bias
layer3.22.bn1.running_mean
layer3.22.bn1.running_var
layer3.22.conv2.weight
layer3.22.bn2.weight
layer3.22.bn2.bias
layer3.22.bn2.running_mean
layer3.22.bn2.running_var
layer3.22.conv3.weight
layer3.22.bn3.weight
layer3.22.bn3.bias
layer3.22.bn3.running_mean
layer3.22.bn3.running_var
layer3.23.conv1.weight
layer3.23.bn1.weight
layer3.23.bn1.bias
layer3.23.bn1.running_mean
layer3.23.bn1.running_var
layer3.23.conv2.weight
layer3.23.bn2.weight
layer3.23.bn2.bias
layer3.23.bn2.running_mean
layer3.23.bn2.running_var
layer3.23.conv3.weight
layer3.23.bn3.weight
layer3.23.bn3.bias
layer3.23.bn3.running_mean
layer3.23.bn3.running_var
layer3.24.conv1.weight
layer3.24.bn1.weight
layer3.24.bn1.bias
layer3.24.bn1.running_mean
layer3.24.bn1.running_var
layer3.24.conv2.weight
layer3.24.bn2.weight
layer3.24.bn2.bias
layer3.24.bn2.running_mean
layer3.24.bn2.running_var
layer3.24.conv3.weight
layer3.24.bn3.weight
layer3.24.bn3.bias
layer3.24.bn3.running_mean
layer3.24.bn3.running_var
layer3.25.conv1.weight
layer3.25.bn1.weight
layer3.25.bn1.bias
layer3.25.bn1.running_mean
layer3.25.bn1.running_var
layer3.25.conv2.weight
layer3.25.bn2.weight
layer3.25.bn2.bias
layer3.25.bn2.running_mean
layer3.25.bn2.running_var
layer3.25.conv3.weight
layer3.25.bn3.weight
layer3.25.bn3.bias
layer3.25.bn3.running_mean
layer3.25.bn3.running_var
layer3.26.conv1.weight
layer3.26.bn1.weight
layer3.26.bn1.bias
layer3.26.bn1.running_mean
layer3.26.bn1.running_var
layer3.26.conv2.weight
layer3.26.bn2.weight
layer3.26.bn2.bias
layer3.26.bn2.running_mean
layer3.26.bn2.running_var
layer3.26.conv3.weight
layer3.26.bn3.weight
layer3.26.bn3.bias
layer3.26.bn3.running_mean
layer3.26.bn3.running_var
layer3.27.conv1.weight
layer3.27.bn1.weight
layer3.27.bn1.bias
layer3.27.bn1.running_mean
layer3.27.bn1.running_var
layer3.27.conv2.weight
layer3.27.bn2.weight
layer3.27.bn2.bias
layer3.27.bn2.running_mean
layer3.27.bn2.running_var
layer3.27.conv3.weight
layer3.27.bn3.weight
layer3.27.bn3.bias
layer3.27.bn3.running_mean
layer3.27.bn3.running_var
layer3.28.conv1.weight
layer3.28.bn1.weight
layer3.28.bn1.bias
layer3.28.bn1.running_mean
layer3.28.bn1.running_var
layer3.28.conv2.weight
layer3.28.bn2.weight
layer3.28.bn2.bias
layer3.28.bn2.running_mean
layer3.28.bn2.running_var
layer3.28.conv3.weight
layer3.28.bn3.weight
layer3.28.bn3.bias
layer3.28.bn3.running_mean
layer3.28.bn3.running_var
layer3.29.conv1.weight
layer3.29.bn1.weight
layer3.29.bn1.bias
layer3.29.bn1.running_mean
layer3.29.bn1.running_var
layer3.29.conv2.weight
layer3.29.bn2.weight
layer3.29.bn2.bias
layer3.29.bn2.running_mean
layer3.29.bn2.running_var
layer3.29.conv3.weight
layer3.29.bn3.weight
layer3.29.bn3.bias
layer3.29.bn3.running_mean
layer3.29.bn3.running_var
layer3.30.conv1.weight
layer3.30.bn1.weight
layer3.30.bn1.bias
layer3.30.bn1.running_mean
layer3.30.bn1.running_var
layer3.30.conv2.weight
layer3.30.bn2.weight
layer3.30.bn2.bias
layer3.30.bn2.running_mean
layer3.30.bn2.running_var
layer3.30.conv3.weight
layer3.30.bn3.weight
layer3.30.bn3.bias
layer3.30.bn3.running_mean
layer3.30.bn3.running_var
layer3.31.conv1.weight
layer3.31.bn1.weight
layer3.31.bn1.bias
layer3.31.bn1.running_mean
layer3.31.bn1.running_var
layer3.31.conv2.weight
layer3.31.bn2.weight
layer3.31.bn2.bias
layer3.31.bn2.running_mean
layer3.31.bn2.running_var
layer3.31.conv3.weight
layer3.31.bn3.weight
layer3.31.bn3.bias
layer3.31.bn3.running_mean
layer3.31.bn3.running_var
layer3.32.conv1.weight
layer3.32.bn1.weight
layer3.32.bn1.bias
layer3.32.bn1.running_mean
layer3.32.bn1.running_var
layer3.32.conv2.weight
layer3.32.bn2.weight
layer3.32.bn2.bias
layer3.32.bn2.running_mean
layer3.32.bn2.running_var
layer3.32.conv3.weight
layer3.32.bn3.weight
layer3.32.bn3.bias
layer3.32.bn3.running_mean
layer3.32.bn3.running_var
layer3.33.conv1.weight
layer3.33.bn1.weight
layer3.33.bn1.bias
layer3.33.bn1.running_mean
layer3.33.bn1.running_var
layer3.33.conv2.weight
layer3.33.bn2.weight
layer3.33.bn2.bias
layer3.33.bn2.running_mean
layer3.33.bn2.running_var
layer3.33.conv3.weight
layer3.33.bn3.weight
layer3.33.bn3.bias
layer3.33.bn3.running_mean
layer3.33.bn3.running_var
layer3.34.conv1.weight
layer3.34.bn1.weight
layer3.34.bn1.bias
layer3.34.bn1.running_mean
layer3.34.bn1.running_var
layer3.34.conv2.weight
layer3.34.bn2.weight
layer3.34.bn2.bias
layer3.34.bn2.running_mean
layer3.34.bn2.running_var
layer3.34.conv3.weight
layer3.34.bn3.weight
layer3.34.bn3.bias
layer3.34.bn3.running_mean
layer3.34.bn3.running_var
layer3.35.conv1.weight
layer3.35.bn1.weight
layer3.35.bn1.bias
layer3.35.bn1.running_mean
layer3.35.bn1.running_var
layer3.35.conv2.weight
layer3.35.bn2.weight
layer3.35.bn2.bias
layer3.35.bn2.running_mean
layer3.35.bn2.running_var
layer3.35.conv3.weight
layer3.35.bn3.weight
layer3.35.bn3.bias
layer3.35.bn3.running_mean
layer3.35.bn3.running_var
layer4.0.conv1.weight
layer4.0.bn1.weight
layer4.0.bn1.bias
layer4.0.bn1.running_mean
layer4.0.bn1.running_var
layer4.0.conv2.weight
layer4.0.bn2.weight
layer4.0.bn2.bias
layer4.0.bn2.running_mean
layer4.0.bn2.running_var
layer4.0.conv3.weight
layer4.0.bn3.weight
layer4.0.bn3.bias
layer4.0.bn3.running_mean
layer4.0.bn3.running_var
layer4.1.conv1.weight
layer4.1.bn1.weight
layer4.1.bn1.bias
layer4.1.bn1.running_mean
layer4.1.bn1.running_var
layer4.1.conv2.weight
layer4.1.bn2.weight
layer4.1.bn2.bias
layer4.1.bn2.running_mean
layer4.1.bn2.running_var
layer4.1.conv3.weight
layer4.1.bn3.weight
layer4.1.bn3.bias
layer4.1.bn3.running_mean
layer4.1.bn3.running_var
layer4.2.conv1.weight
layer4.2.bn1.weight
layer4.2.bn1.bias
layer4.2.bn1.running_mean
layer4.2.bn1.running_var
layer4.2.conv2.weight
layer4.2.bn2.weight
layer4.2.bn2.bias
layer4.2.bn2.running_mean
layer4.2.bn2.running_var
layer4.2.conv3.weight
layer4.2.bn3.weight
layer4.2.bn3.bias
layer4.2.bn3.running_mean
layer4.2.bn3.running_var
layer1.0.downsample.0.weight
layer1.0.downsample.1.weight
layer1.0.downsample.1.bias
layer1.0.downsample.1.running_mean
layer1.0.downsample.1.running_var
layer2.0.downsample.0.weight
layer2.0.downsample.1.weight
layer2.0.downsample.1.bias
layer2.0.downsample.1.running_mean
layer2.0.downsample.1.running_var
layer3.0.downsample.0.weight
layer3.0.downsample.1.weight
layer3.0.downsample.1.bias
layer3.0.downsample.1.running_mean
layer3.0.downsample.1.running_var
layer4.0.downsample.0.weight
layer4.0.downsample.1.weight
layer4.0.downsample.1.bias
layer4.0.downsample.1.running_mean
layer4.0.downsample.1.running_var
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Tip : Three methods to get <code>class</code> or <code>function</code> object from its string name:- <code>getattr(sys.modules[__name__], cfg.GRAPH.STEM)</code></p>
<ul>
<li><code>globals()[cfg.GRAPH.STEM]</code></li>
<li><code>eval(cfg.GRAPH.STEM)</code></li>
</ul>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">set_detect_anomaly</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">out</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_params</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;64,894,538&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-Pretrained-Models">Load Pretrained Models<a class="anchor-link" href="#Load-Pretrained-Models">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torchvision.models</span> <span class="k">import</span> <span class="n">resnet152</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m_resnet152</span> <span class="o">=</span> <span class="n">resnet152</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="vm">__module__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;torchvision.models.resnet&#39;</pre>
</div>

</div>

</div>
</div>

</div>
</div>
 

