---

title: Core
keywords: fastai
sidebar: home_sidebar

summary: "All the basic functions and classes"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convolutional-Operations">Convolutional Operations<a class="anchor-link" href="#Convolutional-Operations">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OprtType" class="doc_header"><code>class</code> <code>OprtType</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OprtType</code>(<strong><code>value</code></strong>, <strong><code>names</code></strong>=<em><code>None</code></em>, <strong><code>module</code></strong>=<em><code>None</code></em>, <strong><code>qualname</code></strong>=<em><code>None</code></em>, <strong><code>type</code></strong>=<em><code>None</code></em>, <strong><code>start</code></strong>=<em><code>1</code></em>) :: <code>Enum</code></p>
</blockquote>
<p>Operator types.<code>Nothing</code> means not any operator there.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="conv_unit" class="doc_header"><code>conv_unit</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>conv_unit</code>(<strong><code>ni</code></strong>:<code>int</code>, <strong><code>no</code></strong>:<code>int</code>, <strong><code>seq</code></strong>:<code>tuple</code>, <strong><code>ks</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>groups</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>act_inplace</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>The basic convolutional operation, which is combination of operators such as conv, bn, relu, etc.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Parameters:</p>
<ul>
<li><code>ni</code> : number of input channels</li>
<li><code>no</code> : number of output channels</li>
<li><code>seq</code> : sequence of operators, a tuple of <a href="/core.html#OprtType"><code>OprtType</code></a> operator types</li>
<li><code>ks</code> : kernel size of conv operator</li>
<li><code>stride</code> : stride size of conv operator</li>
<li><code>groups</code> : number of groups of conv operator</li>
<li><code>zero_bn</code> : does initialize zero value for weight of batch norm operator</li>
<li><code>act_inplace</code> : does do the activations in-place.</li>
</ul>
<p>Return:</p>
<ul>
<li>a nn.Sequential object</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resnet_basicblock" class="doc_header"><code>resnet_basicblock</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L55" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resnet_basicblock</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>, <strong><code>nh</code></strong>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>)</p>
</blockquote>
<p>Basic Unit in Residual Networks</p>
<p>Reference:
Deep Residual Learning for Image Recognition:
<a href="https://arxiv.org/abs/1512.03385">https://arxiv.org/abs/1512.03385</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resnet_bottleneck" class="doc_header"><code>resnet_bottleneck</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L66" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resnet_bottleneck</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>, <strong><code>nh</code></strong>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>groups</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Bottleneck Unit in Residual Networks</p>
<p>Reference:
Deep Residual Learning for Image Recognition:
<a href="https://arxiv.org/abs/1512.03385">https://arxiv.org/abs/1512.03385</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="xception" class="doc_header"><code>xception</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L79" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>xception</code>(<strong><code>ni</code></strong>:<code>int</code>, <strong><code>no</code></strong>:<code>int</code>, <strong><code>nh</code></strong>:<code>int</code>, <strong><code>ks</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Basic unit in xception networks.</p>
<p>Reference:
Xception: Deep Learning with Depthwise Separable Convolutions:
<a href="https://arxiv.org/abs/1610.02357">https://arxiv.org/abs/1610.02357</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Identity-mapping">Identity mapping<a class="anchor-link" href="#Identity-mapping">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IdentityMapping" class="doc_header"><code>class</code> <code>IdentityMapping</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L92" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IdentityMapping</code>(<strong><code>ni</code></strong>:<code>int</code>, <strong><code>no</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>pooling_type</code></strong>:<code>str</code>=<em><code>'max'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Identity Mapping between input and output, four cases:</p>
<ol>
<li>stride == 1 and ni == no
input == output</li>
<li>stride == 1 and ni != no
1x1 conv and bn</li>
<li>stride == 2 and ni == no
maxpool or avgpool</li>
<li>stride == 2 and ni != no
(maxpool or avgpool) and 1x1 conv and bn</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Classifier">Classifier<a class="anchor-link" href="#Classifier">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Classifier" class="doc_header"><code>class</code> <code>Classifier</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L124" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Classifier</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Usually work as the final operator for image processing (classification, object detection, etc.)</p>
<p>Including:
an average pooling op, which downsampling image resolution to 1x1.
a linear op, which perform classification.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Help-functions">Help functions<a class="anchor-link" href="#Help-functions">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="init_cnn" class="doc_header"><code>init_cnn</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L144" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>init_cnn</code>(<strong><code>m</code></strong>)</p>
</blockquote>
<p>copy from <a href="https://github.com/fastai/fastai/blob/master/fastai/vision/models/xresnet.py">https://github.com/fastai/fastai/blob/master/fastai/vision/models/xresnet.py</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="num_params" class="doc_header"><code>num_params</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L152" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>num_params</code>(<strong><code>net</code></strong>:<code>Module</code>)</p>
</blockquote>
<p>Number of parameters of a neural network</p>

</div>

</div>

</div>
</div>

</div>
</div>
 

