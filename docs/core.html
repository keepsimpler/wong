---

title: Core
keywords: fastai
sidebar: home_sidebar

summary: "All the basic functions and classes"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Squeeze-Excite-Block">Squeeze-Excite Block<a class="anchor-link" href="#Squeeze-Excite-Block">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Shuffling-Block">Shuffling Block<a class="anchor-link" href="#Shuffling-Block">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ShuffleBlock" class="doc_header"><code>class</code> <code>ShuffleBlock</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L13" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ShuffleBlock</code>(<strong><code>groups</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convolutional-Operations">Convolutional Operations<a class="anchor-link" href="#Convolutional-Operations">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OprtType" class="doc_header"><code>class</code> <code>OprtType</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L28" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OprtType</code>(<strong><code>value</code></strong>, <strong><code>names</code></strong>=<em><code>None</code></em>, <strong><code>module</code></strong>=<em><code>None</code></em>, <strong><code>qualname</code></strong>=<em><code>None</code></em>, <strong><code>type</code></strong>=<em><code>None</code></em>, <strong><code>start</code></strong>=<em><code>1</code></em>) :: <code>Enum</code></p>
</blockquote>
<p>Operator types.<code>Nothing</code> means not any operator there.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="conv_unit" class="doc_header"><code>conv_unit</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>conv_unit</code>(<strong><code>ni</code></strong>:<code>int</code>, <strong><code>no</code></strong>:<code>int</code>, <strong><code>seq</code></strong>:<code>tuple</code>, <strong><code>ks</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>groups</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>act_inplace</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>The basic convolutional operation, which is combination of operators such as conv, bn, relu, etc.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Parameters:</p>
<ul>
<li><code>ni</code> : number of input channels</li>
<li><code>no</code> : number of output channels</li>
<li><code>seq</code> : sequence of operators, a tuple of <a href="/core.html#OprtType"><code>OprtType</code></a> operator types</li>
<li><code>ks</code> : kernel size of conv operator</li>
<li><code>stride</code> : stride size of conv operator</li>
<li><code>groups</code> : number of groups of conv operator</li>
<li><code>zero_bn</code> : does initialize zero value for weight of batch norm operator</li>
<li><code>act_inplace</code> : does do the activations in-place.</li>
</ul>
<p>Return:</p>
<ul>
<li>a nn.Sequential object</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="n">conv_bn</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="n">ks</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Conv2d(16, 16, kernel_size=(1, 1), stride=(1, 1), bias=False),
 BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pack_relu_conv_bn" class="doc_header"><code>pack_relu_conv_bn</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L74" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pack_relu_conv_bn</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>, <strong><code>nh</code></strong>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>groups</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Packed relu_conv_bn unit</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pack_bn_relu_conv" class="doc_header"><code>pack_bn_relu_conv</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pack_bn_relu_conv</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>, <strong><code>nh</code></strong>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>groups</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pack_relu_conv_bn_shuffle" class="doc_header"><code>pack_relu_conv_bn_shuffle</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L82" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pack_relu_conv_bn_shuffle</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>, <strong><code>nh</code></strong>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>groups</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resnet_basicblock" class="doc_header"><code>resnet_basicblock</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L88" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resnet_basicblock</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>, <strong><code>nh</code></strong>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>)</p>
</blockquote>
<p>Basic Unit in Residual Networks</p>
<p>Reference:
Deep Residual Learning for Image Recognition:
<a href="https://arxiv.org/abs/1512.03385">https://arxiv.org/abs/1512.03385</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resnet_bottleneck" class="doc_header"><code>resnet_bottleneck</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L99" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resnet_bottleneck</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>, <strong><code>nh</code></strong>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>groups</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Bottleneck Unit in Residual Networks</p>
<p>Reference:
Deep Residual Learning for Image Recognition:
<a href="https://arxiv.org/abs/1512.03385">https://arxiv.org/abs/1512.03385</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resnet_basicblock</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">resnet_bottleneck</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Sequential(
   (0): ReLU(inplace=True)
   (1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
   (2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (3): ReLU(inplace=True)
   (4): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
   (5): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
 ), Sequential(
   (0): ReLU(inplace=True)
   (1): Conv2d(16, 8, kernel_size=(1, 1), stride=(1, 1), bias=False)
   (2): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (3): ReLU(inplace=True)
   (4): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
   (5): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (6): ReLU(inplace=True)
   (7): Conv2d(8, 16, kernel_size=(1, 1), stride=(1, 1), bias=False)
   (8): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
 ))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="preresnet_basicblock" class="doc_header"><code>preresnet_basicblock</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>preresnet_basicblock</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>, <strong><code>nh</code></strong>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>)</p>
</blockquote>
<p>Basic Unit in Pre-action Residual Networks, ni == no == nh</p>
<h2 id="Reference:">Reference:<a class="anchor-link" href="#Reference:">&#182;</a></h2><p>Identity Mappings in Deep Residual Networks:
<a href="https://arxiv.org/abs/1603.05027">https://arxiv.org/abs/1603.05027</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="preresnet_bottleneck" class="doc_header"><code>preresnet_bottleneck</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L125" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>preresnet_bottleneck</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>, <strong><code>nh</code></strong>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>groups</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preresnet_basicblock</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">preresnet_bottleneck</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Sequential(
   (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (1): ReLU(inplace=True)
   (2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
   (3): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (4): ReLU(inplace=True)
   (5): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
 ), Sequential(
   (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (1): ReLU(inplace=True)
   (2): Conv2d(16, 8, kernel_size=(1, 1), stride=(1, 1), bias=False)
   (3): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (4): ReLU(inplace=True)
   (5): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
   (6): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (7): ReLU(inplace=True)
   (8): Conv2d(8, 16, kernel_size=(1, 1), stride=(1, 1), bias=False)
 ))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="xception" class="doc_header"><code>xception</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L132" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>xception</code>(<strong><code>ni</code></strong>:<code>int</code>, <strong><code>no</code></strong>:<code>int</code>, <strong><code>nh</code></strong>:<code>int</code>, <strong><code>ks</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>zero_bn</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Basic unit in xception networks.</p>
<p>Reference:
Xception: Deep Learning with Depthwise Separable Convolutions:
<a href="https://arxiv.org/abs/1610.02357">https://arxiv.org/abs/1610.02357</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mbconv" class="doc_header"><code>mbconv</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mbconv</code>(<strong><code>ni</code></strong>:<code>int</code>, <strong><code>no</code></strong>:<code>int</code>, <strong><code>nh</code></strong>:<code>int</code>, <strong><code>ks</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>groups</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>zero_bn</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Mobile Inverted Bottleneck block in MobileNetV2</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mbconv</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential(
  (0): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
  (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): ReLU(inplace=True)
  (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=64, bias=False)
  (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (5): ReLU(inplace=True)
  (6): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1), bias=False)
  (7): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Stemming-Stage">Stemming Stage<a class="anchor-link" href="#Stemming-Stage">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resnet_stem" class="doc_header"><code>resnet_stem</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L153" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resnet_stem</code>(<strong><code>ni</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong><code>no</code></strong>:<code>int</code>=<em><code>64</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resnet_stem_deep" class="doc_header"><code>resnet_stem_deep</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L160" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resnet_stem_deep</code>(<strong><code>ni</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong><code>no</code></strong>:<code>int</code>=<em><code>64</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resnet_stem</span><span class="p">(),</span> <span class="n">resnet_stem_deep</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Sequential(
   (0): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
   (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (2): ReLU(inplace=True)
   (3): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
 ), Sequential(
   (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
   (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (2): ReLU(inplace=True)
   (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
   (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (5): ReLU(inplace=True)
   (6): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
   (7): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (8): ReLU(inplace=True)
   (9): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
 ))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Identity-mapping">Identity mapping<a class="anchor-link" href="#Identity-mapping">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IdentityMappingMaxPool" class="doc_header"><code>class</code> <code>IdentityMappingMaxPool</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L171" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IdentityMappingMaxPool</code>(<strong><code>ni</code></strong>:<code>int</code>, <strong><code>no</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Identity Mapping using maxpool to accross stage, four cases:</p>
<ol>
<li>stride == 1 and ni == no
input == output</li>
<li>stride == 1 and ni != no
1x1 conv --&gt; bn</li>
<li>stride == 2 and ni == no
maxpool</li>
<li>stride == 2 and ni != no
(maxpool) --&gt; 1x1 conv --&gt; bn</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IdentityMappingAvgPool" class="doc_header"><code>class</code> <code>IdentityMappingAvgPool</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L198" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IdentityMappingAvgPool</code>(<strong><code>ni</code></strong>:<code>int</code>, <strong><code>no</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Identity Mapping using avgpool to accross stage, four cases:</p>
<ol>
<li>stride == 1 and ni == no
input == output</li>
<li>stride == 1 and ni != no
1x1 conv --&gt; bn</li>
<li>stride == 2 and ni == no
avgpool</li>
<li>stride == 2 and ni != no
(avgpool) --&gt; 1x1 conv --&gt; bn</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IdentityMapping" class="doc_header"><code>class</code> <code>IdentityMapping</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L226" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IdentityMapping</code>(<strong><code>ni</code></strong>:<code>int</code>, <strong><code>no</code></strong>:<code>int</code>, <strong><code>stride</code></strong>:<code>int</code>=<em><code>1</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Identity mapping of ResNet.
Identity mapping of ResNet, two cases:</p>
<ol>
<li>stride == 1 and ni == no
input == output</li>
<li>else
1x1 conv with stride --&gt; bn</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">IdentityMapping</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">IdentityMapping</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> \
<span class="n">IdentityMapping</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">IdentityMapping</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(IdentityMapping(
   (unit): Sequential(
     (0): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
     (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   )
 ), IdentityMapping(
   (unit): Sequential(
     (0): Conv2d(16, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)
     (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   )
 ), IdentityMapping(
   (unit): Sequential()
 ), IdentityMapping(
   (unit): Sequential(
     (0): Conv2d(16, 16, kernel_size=(1, 1), stride=(2, 2), bias=False)
     (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   )
 ))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">IdentityMapping</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(True)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Classifier">Classifier<a class="anchor-link" href="#Classifier">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Classifier" class="doc_header"><code>class</code> <code>Classifier</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L247" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Classifier</code>(<strong><code>ni</code></strong>, <strong><code>no</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Usually work as the final operator for image processing (classification, object detection, etc.)</p>
<p>Including:
an average pooling op, which downsampling image resolution to 1x1.
a linear op, which perform classification.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Help-functions">Help functions<a class="anchor-link" href="#Help-functions">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="init_cnn" class="doc_header"><code>init_cnn</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L267" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>init_cnn</code>(<strong><code>m</code></strong>)</p>
</blockquote>
<p>copy from <a href="https://github.com/fastai/fastai/blob/master/fastai/vision/models/xresnet.py">https://github.com/fastai/fastai/blob/master/fastai/vision/models/xresnet.py</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="num_params" class="doc_header"><code>num_params</code><a href="https://github.com/keepsimpler/wong/tree/master/wong/core.py#L275" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>num_params</code>(<strong><code>net</code></strong>:<code>Module</code>)</p>
</blockquote>
<p>Number of parameters of a neural network</p>

</div>

</div>

</div>
</div>

</div>
</div>
 

