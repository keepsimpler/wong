---

title: Graph

keywords: fastai
sidebar: home_sidebar

summary: "Generate DAG graphs that abstract architectures of CNNs"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\02_graph.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ResNets">ResNets<a class="anchor-link" href="#ResNets">&#182;</a></h2><blockquote><p>The DAG graphs of ResNets.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastdot</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">layers1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="s1">&#39;lin&#39;</span><span class="p">]</span>
<span class="n">layers2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;conv&#39;</span><span class="p">,</span> <span class="s1">&#39;lin&#39;</span><span class="p">]</span>
<span class="n">block1</span><span class="p">,</span> <span class="n">block2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;block1&#39;</span><span class="p">,</span> <span class="s1">&#39;block2&#39;</span><span class="p">]</span>
<span class="n">conns</span> <span class="o">=</span> <span class="p">((</span><span class="n">block1</span><span class="p">,</span> <span class="n">block2</span><span class="p">),</span>
         <span class="p">(</span><span class="n">block1</span><span class="p">,</span> <span class="n">layers2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">graph_items</span><span class="p">(</span><span class="n">seq_cluster</span><span class="p">(</span><span class="n">layers1</span><span class="p">,</span> <span class="n">block1</span><span class="p">),</span>
                <span class="n">seq_cluster</span><span class="p">(</span><span class="n">layers2</span><span class="p">,</span> <span class="n">block2</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_items</span><span class="p">(</span><span class="o">*</span><span class="n">object_connections</span><span class="p">(</span><span class="n">conns</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [&lt;pydot.Edge object at 0x000002098D314408&gt;,&lt;pydot.Edge object at 0x000002098D31B588&gt;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: G Pages: 1 -->
<svg width="454pt" height="111pt"
 viewBox="0.00 0.00 454.00 111.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 107)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-107 450,-107 450,4 -4,4"/>
<g id="clust1" class="cluster"><title>cluster_ne3a882c0152e41a2ba59840cad126797</title>
<g id="a_clust1"><a xlink:title="block1">
<path fill="#555555" fill-opacity="0.133333" stroke="black" d="M20,-8C20,-8 246,-8 246,-8 252,-8 258,-14 258,-20 258,-20 258,-71 258,-71 258,-77 252,-83 246,-83 246,-83 20,-83 20,-83 14,-83 8,-77 8,-71 8,-71 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="133" y="-67.8" font-family="Times New Roman,serif" font-size="14.00">block1</text>
</a>
</g>
</g>
<g id="clust2" class="cluster"><title>cluster_nd5af1682d91e471283f4e2be27bead94</title>
<g id="a_clust2"><a xlink:title="block2">
<path fill="#555555" fill-opacity="0.133333" stroke="black" d="M290,-20C290,-20 426,-20 426,-20 432,-20 438,-26 438,-32 438,-32 438,-83 438,-83 438,-89 432,-95 426,-95 426,-95 290,-95 290,-95 284,-95 278,-89 278,-83 278,-83 278,-32 278,-32 278,-26 284,-20 290,-20"/>
<text text-anchor="middle" x="358" y="-79.8" font-family="Times New Roman,serif" font-size="14.00">block2</text>
</a>
</g>
</g>
<!-- n9e47596116614191ab835b1f23c37a41 -->
<g id="node1" class="node"><title>n9e47596116614191ab835b1f23c37a41</title>
<g id="a_node1"><a xlink:title="conv">
<path fill="#169bf2" fill-opacity="0.439216" stroke="black" d="M58,-52C58,-52 28,-52 28,-52 22,-52 16,-46 16,-40 16,-40 16,-28 16,-28 16,-22 22,-16 28,-16 28,-16 58,-16 58,-16 64,-16 70,-22 70,-28 70,-28 70,-40 70,-40 70,-46 64,-52 58,-52"/>
<text text-anchor="middle" x="43" y="-30.3" font-family="Times New Roman,serif" font-size="14.00">conv</text>
</a>
</g>
</g>
<!-- nc1aa8196415f43fca294aebba868d3ae -->
<g id="node2" class="node"><title>nc1aa8196415f43fca294aebba868d3ae</title>
<g id="a_node2"><a xlink:title="conv">
<path fill="#169bf2" fill-opacity="0.439216" stroke="black" d="M148,-52C148,-52 118,-52 118,-52 112,-52 106,-46 106,-40 106,-40 106,-28 106,-28 106,-22 112,-16 118,-16 118,-16 148,-16 148,-16 154,-16 160,-22 160,-28 160,-28 160,-40 160,-40 160,-46 154,-52 148,-52"/>
<text text-anchor="middle" x="133" y="-30.3" font-family="Times New Roman,serif" font-size="14.00">conv</text>
</a>
</g>
</g>
<!-- n9e47596116614191ab835b1f23c37a41&#45;&gt;nc1aa8196415f43fca294aebba868d3ae -->
<g id="edge1" class="edge"><title>n9e47596116614191ab835b1f23c37a41&#45;&gt;nc1aa8196415f43fca294aebba868d3ae</title>
<path fill="none" stroke="black" d="M70.4029,-34C78.3932,-34 87.3106,-34 95.8241,-34"/>
<polygon fill="black" stroke="black" points="95.919,-37.5001 105.919,-34 95.919,-30.5001 95.919,-37.5001"/>
</g>
<!-- nd01bb33d7b704f42bb513726b8a731a8 -->
<g id="node3" class="node"><title>nd01bb33d7b704f42bb513726b8a731a8</title>
<g id="a_node3"><a xlink:title="lin">
<path fill="#beec8e" fill-opacity="0.588235" stroke="black" d="M238,-52C238,-52 208,-52 208,-52 202,-52 196,-46 196,-40 196,-40 196,-28 196,-28 196,-22 202,-16 208,-16 208,-16 238,-16 238,-16 244,-16 250,-22 250,-28 250,-28 250,-40 250,-40 250,-46 244,-52 238,-52"/>
<text text-anchor="middle" x="223" y="-30.3" font-family="Times New Roman,serif" font-size="14.00">lin</text>
</a>
</g>
</g>
<!-- nc1aa8196415f43fca294aebba868d3ae&#45;&gt;nd01bb33d7b704f42bb513726b8a731a8 -->
<g id="edge2" class="edge"><title>nc1aa8196415f43fca294aebba868d3ae&#45;&gt;nd01bb33d7b704f42bb513726b8a731a8</title>
<path fill="none" stroke="black" d="M160.403,-34C168.393,-34 177.311,-34 185.824,-34"/>
<polygon fill="black" stroke="black" points="185.919,-37.5001 195.919,-34 185.919,-30.5001 185.919,-37.5001"/>
</g>
<!-- n935427e0863f487c957068acfb96063e -->
<g id="node4" class="node"><title>n935427e0863f487c957068acfb96063e</title>
<g id="a_node4"><a xlink:title="conv">
<path fill="#169bf2" fill-opacity="0.439216" stroke="black" d="M328,-64C328,-64 298,-64 298,-64 292,-64 286,-58 286,-52 286,-52 286,-40 286,-40 286,-34 292,-28 298,-28 298,-28 328,-28 328,-28 334,-28 340,-34 340,-40 340,-40 340,-52 340,-52 340,-58 334,-64 328,-64"/>
<text text-anchor="middle" x="313" y="-42.3" font-family="Times New Roman,serif" font-size="14.00">conv</text>
</a>
</g>
</g>
<!-- nd01bb33d7b704f42bb513726b8a731a8&#45;&gt;n935427e0863f487c957068acfb96063e -->
<g id="edge4" class="edge"><title>nd01bb33d7b704f42bb513726b8a731a8&#45;&gt;n935427e0863f487c957068acfb96063e</title>
<path fill="none" stroke="black" d="M257.73,-38.5995C263.652,-39.4071 269.838,-40.2506 275.824,-41.0669"/>
<polygon fill="black" stroke="black" points="267.549,-43.1865 278,-41.4435 268.743,-36.2891 267.549,-43.1865"/>
</g>
<!-- n17fb6d4eebec4971a62fa98f0c89f6a7 -->
<g id="node5" class="node"><title>n17fb6d4eebec4971a62fa98f0c89f6a7</title>
<g id="a_node5"><a xlink:title="lin">
<path fill="#beec8e" fill-opacity="0.588235" stroke="black" d="M418,-64C418,-64 388,-64 388,-64 382,-64 376,-58 376,-52 376,-52 376,-40 376,-40 376,-34 382,-28 388,-28 388,-28 418,-28 418,-28 424,-28 430,-34 430,-40 430,-40 430,-52 430,-52 430,-58 424,-64 418,-64"/>
<text text-anchor="middle" x="403" y="-42.3" font-family="Times New Roman,serif" font-size="14.00">lin</text>
</a>
</g>
</g>
<!-- nd01bb33d7b704f42bb513726b8a731a8&#45;&gt;n17fb6d4eebec4971a62fa98f0c89f6a7 -->
<g id="edge5" class="edge"><title>nd01bb33d7b704f42bb513726b8a731a8&#45;&gt;n17fb6d4eebec4971a62fa98f0c89f6a7</title>
<path fill="none" stroke="black" d="M257.697,-23.1332C264.359,-21.4144 271.348,-19.9067 278,-19 305.303,-15.2784 313.023,-13.3809 340,-19 348.935,-20.8612 358.161,-24.082 366.678,-27.6649"/>
<polygon fill="black" stroke="black" points="365.381,-30.9189 375.938,-31.8109 368.241,-24.53 365.381,-30.9189"/>
</g>
<!-- n935427e0863f487c957068acfb96063e&#45;&gt;n17fb6d4eebec4971a62fa98f0c89f6a7 -->
<g id="edge3" class="edge"><title>n935427e0863f487c957068acfb96063e&#45;&gt;n17fb6d4eebec4971a62fa98f0c89f6a7</title>
<path fill="none" stroke="black" d="M340.403,-46C348.393,-46 357.311,-46 365.824,-46"/>
<polygon fill="black" stroke="black" points="365.919,-49.5001 375.919,-46 365.919,-42.5001 365.919,-49.5001"/>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
</div>
 

